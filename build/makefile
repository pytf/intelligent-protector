TOP_DIR=${AGENT_ROOT}
BIN_DIR=${AGENT_ROOT}/bin
PLUGINS_DIR=${AGENT_ROOT}/bin/plugins

SRC_AGENT_DIR = ${TOP_DIR}/src/src/agent
SRC_ROOT_EXEC_DIR = ${TOP_DIR}/src/src/rootexec
SRC_CRYPTO_DIR = ${TOP_DIR}/src/src/tools/crypto
SRC_SCRIPTSIGN_DIR = ${TOP_DIR}/src/src/tools/scriptsign
SRC_DATAMIGRATION_DIR = ${TOP_DIR}/src/src/tools/datamigration
SRC_MONITOR_DIR = ${TOP_DIR}/src/src/tools/monitor
SRC_XMLCFG_DIR = ${TOP_DIR}/src/src/tools/xmlcfg
SRC_AGENTCLI_DIR = ${TOP_DIR}/src/src/tools/agentcli
SRC_GETINPUT_DIR = ${TOP_DIR}/src/src/tools/getinput
SRC_APPS_DIR = ${TOP_DIR}/src/src/apps
SRC_APPS_DB2_DIR = ${TOP_DIR}/src/src/apps/db2
SRC_APPS_ORACLE_DIR = ${TOP_DIR}/src/src/apps/oracle
SRC_APPS_CACHE_DIR = ${TOP_DIR}/src/src/apps/cache
SRC_APPS_SYBASE_DIR = ${TOP_DIR}/src/src/apps/sybase
SRC_APPS_HANA_DIR = ${TOP_DIR}/src/src/apps/hana
SRC_APPS_APP_DIR = ${TOP_DIR}/src/src/apps/app
SRC_ARRAY_DIR = ${TOP_DIR}/src/src/array
SRC_CLUSTER_DIR = ${TOP_DIR}/src/src/cluster
SRC_COMMON_DIR = ${TOP_DIR}/src/src/common
SRC_DEVICE_DIR = ${TOP_DIR}/src/src/device
SRC_HOST_DIR = ${TOP_DIR}/src/src/host
SRC_PLUGINFX_DIR = ${TOP_DIR}/src/src/pluginfx
SRC_PLUGINS_DIR = ${TOP_DIR}/src/src/plugins
SRC_PLUGINS_DEVICE_DIR = ${TOP_DIR}/src/src/plugins/device
SRC_PLUGINS_HOST_DIR = ${TOP_DIR}/src/src/plugins/host
SRC_PLUGINS_DB2_DIR = ${TOP_DIR}/src/src/plugins/db2
SRC_PLUGINS_ORACLE_DIR = ${TOP_DIR}/src/src/plugins/oracle
SRC_PLUGINS_CLUSTER_DIR = ${TOP_DIR}/src/src/plugins/cluster
SRC_PLUGINS_CACHE_DIR = ${TOP_DIR}/src/src/plugins/cache
SRC_PLUGINS_SYBASE_DIR = ${TOP_DIR}/src/src/plugins/sybase
SRC_PLUGINS_HANA_DIR = ${TOP_DIR}/src/src/plugins/hana
SRC_PLUGINS_APP_DIR = ${TOP_DIR}/src/src/plugins/app
SRC_REST_DIR = ${TOP_DIR}/src/src/rest
SRC_ALARM_DIR = ${TOP_DIR}/src/src/alarm
SRC_SECUREC_DIR = ${TOP_DIR}/src/src/securec
SRC_KMC_DIR = ${TOP_DIR}/src/src/kmc
SRC_JSON_DIR = ${TOP_DIR}/open_src/jsoncpp/src/lib_json
SRC_TINYXML_DIR = ${TOP_DIR}/open_src/tinyxml

BASE_INC = ${TOP_DIR}/src/inc
INC_SECUREC_DIR = ${TOP_DIR}/src/inc/securec/
INC_KMC_DIR = ${TOP_DIR}/src/inc/kmc

OPEN_SRC_DIR = ${TOP_DIR}/open_src
PLATORM_SRC_DIR = ${TOP_DIR}/platform
BASE_OPEN_INC = ${OPEN_SRC_DIR}
OPEN_OPENSSL_DIR = ${OPEN_SRC_DIR}/openssl
OPEN_SNMP_DIR = ${OPEN_SRC_DIR}/snmp++
OPEN_FCGI_DIR = ${OPEN_SRC_DIR}/fcgi
OPEN_SQLITE_DIR = ${OPEN_SRC_DIR}/sqlite
OPEN_FCGI_DIR = ${OPEN_SRC_DIR}/fcgi
OPEN_JSON_DIR = ${OPEN_SRC_DIR}/jsoncpp
OPEN_TINYXML_DIR = ${OPEN_SRC_DIR}/tinyxml
SRC_OPEN_SQLITE_DIR = ${OPEN_SQLITE_DIR}
INC_OPEN_SQLITE_DIR = ${OPEN_SQLITE_DIR}
INC_OPEN_OPENSSL_DIR = ${OPEN_OPENSSL_DIR}/include
INC_OPEN_SNMP_DIR = ${OPEN_SNMP_DIR}/include
INC_OPEN_SNMP_MAIN_DIR = ${OPEN_SNMP_DIR}
INC_OPEN_JSON_DIR = ${OPEN_JSON_DIR}/include
SRC_OPEN_TINYXML_DIR = ${OPEN_TINYXML_DIR}
INC_OPEN_TINYXML_DIR = ${OPEN_TINYXML_DIR}
OPEN_OPENSSL_LIB_DIR = ${OPEN_OPENSSL_DIR}/.openssl/lib
OPEN_SNMP_LIB_DIR = ${OPEN_SNMP_DIR}/src/.libs
OPEN_FCGI_LIB_DIR = ${OPEN_FCGI_DIR}/.fcgi/lib

OBJ_DIR = ${TOP_DIR}/obj
OBJ_AGENT_DIR = ${OBJ_DIR}/agent
OBJ_ROOT_EXEC_DIR = ${OBJ_DIR}/rootexec
OBJ_MONITOR_DIR = ${OBJ_DIR}/monitor
OBJ_CRYPTO_DIR = ${OBJ_DIR}/crypto
OBJ_SCRIPTSIGN_DIR = ${OBJ_DIR}/scriptsign
OBJ_DATAMIGRATION_DIR = ${OBJ_DIR}/datamigration
OBJ_XMLCFG_DIR = ${OBJ_DIR}/xmlcfg
OBJ_AGENTCLI_DIR = ${OBJ_DIR}/agentcli
OBJ_GETINPUT_DIR = ${OBJ_DIR}/getinput
OBJ_APPS_DIR = ${OBJ_DIR}/apps
OBJ_APPS_DB2_DIR = ${OBJ_DIR}/apps/db2
OBJ_APPS_ORACLE_DIR = ${OBJ_DIR}/apps/oracle
OBJ_APPS_CACHE_DIR = ${OBJ_DIR}/apps/cache
OBJ_APPS_SYBASE_DIR = ${OBJ_DIR}/apps/sybase
OBJ_APPS_HANA_DIR = ${OBJ_DIR}/apps/hana
OBJ_APPS_APP_DIR = ${OBJ_DIR}/apps/app
OBJ_ARRAY_DIR = ${OBJ_DIR}/array
OBJ_CLUSTER_DIR = ${OBJ_DIR}/cluster
OBJ_COMMON_DIR = ${OBJ_DIR}/common
OBJ_DEVICE_DIR = ${OBJ_DIR}/device
OBJ_HOST_DIR = ${OBJ_DIR}/host
OBJ_PLUGINFX_DIR = ${OBJ_DIR}/pluginfx
OBJ_PLUGINS_DIR = ${OBJ_DIR}/plugins
OBJ_PLUGINS_DEVICE_DIR = ${OBJ_DIR}/plugins/device
OBJ_PLUGINS_HOST_DIR = ${OBJ_DIR}/plugins/host
OBJ_PLUGINS_DB2_DIR = ${OBJ_DIR}/plugins/db2
OBJ_PLUGINS_ORACLE_DIR = ${OBJ_DIR}/plugins/oracle
OBJ_PLUGINS_CLUSTER_DIR = ${OBJ_DIR}/plugins/cluster
OBJ_PLUGINS_CACHE_DIR = ${OBJ_DIR}/plugins/cache
OBJ_PLUGINS_SYBASE_DIR = ${OBJ_DIR}/plugins/sybase
OBJ_PLUGINS_HANA_DIR = ${OBJ_DIR}/plugins/hana
OBJ_PLUGINS_APP_DIR = ${OBJ_DIR}/plugins/app
OBJ_REST_DIR = ${OBJ_DIR}/rest
OBJ_ALARM_DIR = ${OBJ_DIR}/alarm
OBJ_SQLITE_DIR = ${OBJ_DIR}/sqlite
OBJ_JSON_DIR = ${OBJ_DIR}/json
OBJ_TINYXML_DIR = ${OBJ_DIR}/tinyxml
OBJ_SECUREC_DIR = ${OBJ_DIR}/securec
OBJ_KMC_DIR = ${OBJ_DIR}/kmc

AGENT_SRCS = $(wildcard ${SRC_AGENT_DIR}/*.cpp)
AGENT_OBJS = $(patsubst ${SRC_AGENT_DIR}/%.cpp, ${OBJ_AGENT_DIR}/%.o, $(AGENT_SRCS))
ROOT_EXEC_SRCS = $(wildcard ${SRC_ROOT_EXEC_DIR}/*.cpp)
ROOT_EXEC_OBJS = $(patsubst ${SRC_ROOT_EXEC_DIR}/%.cpp, ${OBJ_ROOT_EXEC_DIR}/%.o, $(ROOT_EXEC_SRCS))
CRYPTO_SRCS = $(wildcard ${SRC_CRYPTO_DIR}/*.cpp)
CRYPTO_OBJS = $(patsubst ${SRC_CRYPTO_DIR}/%.cpp, ${OBJ_CRYPTO_DIR}/%.o, $(CRYPTO_SRCS))
SCRIPTSIGN_SRCS = $(wildcard ${SRC_SCRIPTSIGN_DIR}/*.cpp)
SCRIPTSIGN_OBJS = $(patsubst ${SRC_SCRIPTSIGN_DIR}/%.cpp, ${OBJ_SCRIPTSIGN_DIR}/%.o, $(SCRIPTSIGN_SRCS))
DATAMIGRATION_SRCS = $(wildcard ${SRC_DATAMIGRATION_DIR}/*.cpp)
DATAMIGRATION_OBJS = $(patsubst ${SRC_DATAMIGRATION_DIR}/%.cpp, ${OBJ_DATAMIGRATION_DIR}/%.o, $(DATAMIGRATION_SRCS))
MONITOR_SRCS = $(wildcard ${SRC_MONITOR_DIR}/*.cpp)
MONITOR_OBJS = $(patsubst ${SRC_MONITOR_DIR}/%.cpp, ${OBJ_MONITOR_DIR}/%.o, $(MONITOR_SRCS))
XMLCFG_SRCS = $(wildcard ${SRC_XMLCFG_DIR}/*.cpp)
XMLCFG_OBJS = $(patsubst ${SRC_XMLCFG_DIR}/%.cpp, ${OBJ_XMLCFG_DIR}/%.o, $(XMLCFG_SRCS))
AGENTCLI_SRCS = $(wildcard ${SRC_AGENTCLI_DIR}/*.cpp)
AGENTCLI_OBJS = $(patsubst ${SRC_AGENTCLI_DIR}/%.cpp, ${OBJ_AGENTCLI_DIR}/%.o, $(AGENTCLI_SRCS))
GETINPUT_SRCS = $(wildcard ${SRC_GETINPUT_DIR}/*.cpp)
GETINPUT_OBJS = $(patsubst ${SRC_GETINPUT_DIR}/%.cpp, ${OBJ_GETINPUT_DIR}/%.o, $(GETINPUT_SRCS))
APPS_DB2_SRCS = $(wildcard ${SRC_APPS_DB2_DIR}/*.cpp)
APPS_DB2_OBJS = $(patsubst ${SRC_APPS_DB2_DIR}/%.cpp, ${OBJ_APPS_DB2_DIR}/%.o, $(APPS_DB2_SRCS))
APPS_ORACLE_SRCS = $(wildcard ${SRC_APPS_ORACLE_DIR}/*.cpp)
APPS_ORACLE_OBJS = $(patsubst ${SRC_APPS_ORACLE_DIR}/%.cpp, ${OBJ_APPS_ORACLE_DIR}/%.o, $(APPS_ORACLE_SRCS))
APPS_CACHE_SRCS = $(wildcard ${SRC_APPS_CACHE_DIR}/*.cpp)
APPS_CACHE_OBJS = $(patsubst ${SRC_APPS_CACHE_DIR}/%.cpp, ${OBJ_APPS_CACHE_DIR}/%.o, $(APPS_CACHE_SRCS))
APPS_SYBASE_SRCS = $(wildcard ${SRC_APPS_SYBASE_DIR}/*.cpp)
APPS_SYBASE_OBJS = $(patsubst ${SRC_APPS_SYBASE_DIR}/%.cpp, ${OBJ_APPS_SYBASE_DIR}/%.o, $(APPS_SYBASE_SRCS))
APPS_HANA_SRCS = $(wildcard ${SRC_APPS_HANA_DIR}/*.cpp)
APPS_HANA_OBJS = $(patsubst ${SRC_APPS_HANA_DIR}/%.cpp, ${OBJ_APPS_HANA_DIR}/%.o, $(APPS_HANA_SRCS))
APPS_APP_SRCS = $(wildcard ${SRC_APPS_APP_DIR}/*.cpp)
APPS_APP_OBJS = $(patsubst ${SRC_APPS_APP_DIR}/%.cpp, ${OBJ_APPS_APP_DIR}/%.o, $(APPS_APP_SRCS))
ARRAY_RCS = $(wildcard ${SRC_ARRAY_DIR}/*.cpp)
ARRAY_OBJS = $(patsubst ${SRC_ARRAY_DIR}/%.cpp, ${OBJ_ARRAY_DIR}/%.o, $(ARRAY_RCS))
CLUSTER_RCS = $(wildcard ${SRC_CLUSTER_DIR}/*.cpp)
CLUSTER_OBJS = $(patsubst ${SRC_CLUSTER_DIR}/%.cpp, ${OBJ_CLUSTER_DIR}/%.o, $(CLUSTER_RCS))
COMMON_RCS = $(wildcard ${SRC_COMMON_DIR}/*.cpp)
COMMON_OBJS = $(patsubst ${SRC_COMMON_DIR}/%.cpp, ${OBJ_COMMON_DIR}/%.o, $(COMMON_RCS))
DEVICE_RCS = $(wildcard ${SRC_DEVICE_DIR}/*.cpp)
DEVICE_OBJS = $(patsubst ${SRC_DEVICE_DIR}/%.cpp, ${OBJ_DEVICE_DIR}/%.o, $(DEVICE_RCS))
HOST_RCS = $(wildcard ${SRC_HOST_DIR}/*.cpp)
HOST_OBJS = $(patsubst ${SRC_HOST_DIR}/%.cpp, ${OBJ_HOST_DIR}/%.o, $(HOST_RCS))
PLUGINFX_SRCS = $(wildcard ${SRC_PLUGINFX_DIR}/*.cpp)
PLUGINFX_OBJS = $(patsubst ${SRC_PLUGINFX_DIR}/%.cpp, ${OBJ_PLUGINFX_DIR}/%.o, $(PLUGINFX_SRCS))
PLUGINS_SRCS = $(wildcard ${SRC_PLUGINS_DIR}/*.cpp)
PLUGINS_OBJS = $(patsubst ${SRC_PLUGINS_DIR}/%.cpp, ${OBJ_PLUGINS_DIR}/%.o, $(PLUGINS_SRCS))
PLUGINS_DEVICE_SRCS = $(wildcard ${SRC_PLUGINS_DEVICE_DIR}/*.cpp)
PLUGINS_DEVICE_OBJS = $(patsubst ${SRC_PLUGINS_DEVICE_DIR}/%.cpp, ${OBJ_PLUGINS_DEVICE_DIR}/%.o, $(PLUGINS_DEVICE_SRCS))
PLUGINS_HOST_SRCS = $(wildcard ${SRC_PLUGINS_HOST_DIR}/*.cpp)
PLUGINS_HOST_OBJS = $(patsubst ${SRC_PLUGINS_HOST_DIR}/%.cpp, ${OBJ_PLUGINS_HOST_DIR}/%.o, $(PLUGINS_HOST_SRCS))
PLUGINS_DB2_SRCS = $(wildcard ${SRC_PLUGINS_DB2_DIR}/*.cpp)
PLUGINS_DB2_OBJS = $(patsubst ${SRC_PLUGINS_DB2_DIR}/%.cpp, ${OBJ_PLUGINS_DB2_DIR}/%.o, $(PLUGINS_DB2_SRCS))
PLUGINS_ORACLE_SRCS = $(wildcard ${SRC_PLUGINS_ORACLE_DIR}/*.cpp)
PLUGINS_ORACLE_OBJS = $(patsubst ${SRC_PLUGINS_ORACLE_DIR}/%.cpp, ${OBJ_PLUGINS_ORACLE_DIR}/%.o, $(PLUGINS_ORACLE_SRCS))
PLUGINS_CLUSTER_SRCS = $(wildcard ${SRC_PLUGINS_CLUSTER_DIR}/*.cpp)
PLUGINS_CLUSTER_OBJS = $(patsubst ${SRC_PLUGINS_CLUSTER_DIR}/%.cpp, ${OBJ_PLUGINS_CLUSTER_DIR}/%.o, $(PLUGINS_CLUSTER_SRCS))
PLUGINS_CACHE_SRCS = $(wildcard ${SRC_PLUGINS_CACHE_DIR}/*.cpp)
PLUGINS_CACHE_OBJS = $(patsubst ${SRC_PLUGINS_CACHE_DIR}/%.cpp, ${OBJ_PLUGINS_CACHE_DIR}/%.o, $(PLUGINS_CACHE_SRCS))
PLUGINS_SYBASE_SRCS = $(wildcard ${SRC_PLUGINS_SYBASE_DIR}/*.cpp)
PLUGINS_SYBASE_OBJS = $(patsubst ${SRC_PLUGINS_SYBASE_DIR}/%.cpp, ${OBJ_PLUGINS_SYBASE_DIR}/%.o, $(PLUGINS_SYBASE_SRCS))
PLUGINS_HANA_SRCS = $(wildcard ${SRC_PLUGINS_HANA_DIR}/*.cpp)
PLUGINS_HANA_OBJS = $(patsubst ${SRC_PLUGINS_HANA_DIR}/%.cpp, ${OBJ_PLUGINS_HANA_DIR}/%.o, $(PLUGINS_HANA_SRCS))
PLUGINS_APP_SRCS = $(wildcard ${SRC_PLUGINS_APP_DIR}/*.cpp)
PLUGINS_APP_OBJS = $(patsubst ${SRC_PLUGINS_APP_DIR}/%.cpp, ${OBJ_PLUGINS_APP_DIR}/%.o, $(PLUGINS_APP_SRCS))

REST_SRCS = $(wildcard ${SRC_REST_DIR}/*.cpp)
REST_OBJS = $(patsubst ${SRC_REST_DIR}/%.cpp, ${OBJ_REST_DIR}/%.o, $(REST_SRCS))
ALARM_SRCS = $(wildcard ${SRC_ALARM_DIR}/*.cpp)
ALARM_OBJS = $(patsubst ${SRC_ALARM_DIR}/%.cpp, ${OBJ_ALARM_DIR}/%.o, $(ALARM_SRCS))
SECUREC_SRCS = $(wildcard ${SRC_SECUREC_DIR}/*.c)
SECUREC_OBJS = $(patsubst ${SRC_SECUREC_DIR}/%.c, ${OBJ_SECUREC_DIR}/%.o, $(SECUREC_SRCS))
KMC_SRCS = $(wildcard ${SRC_KMC_DIR}/*.cpp)
KMC_OBJS = $(patsubst ${SRC_KMC_DIR}/%.cpp, ${OBJ_KMC_DIR}/%.o, $(KMC_SRCS))
JSON_SRCS = $(wildcard ${SRC_JSON_DIR}/*.cpp)
JSON_OBJS = $(patsubst ${SRC_JSON_DIR}/%.cpp, ${OBJ_JSON_DIR}/%.o, $(JSON_SRCS))
SQLITE_OBJS = ${OBJ_SQLITE_DIR}/sqlite3.o
TINYXML_SRCS = $(wildcard ${SRC_TINYXML_DIR}/tiny*.cpp)
TINYXML_OBJS = $(patsubst ${SRC_TINYXML_DIR}/%.cpp, ${OBJ_TINYXML_DIR}/%.o, $(TINYXML_SRCS))

RD_CFLAGS = -DWITH_OPENSSL

AGENT = ${BIN_DIR}/rdagent
ROOTEXEC = ${BIN_DIR}/rootexec
CRYPTO = ${BIN_DIR}/crypto
SCRIPTSIGN = ${BIN_DIR}/scriptsign
DATAMIGRATION = ${BIN_DIR}/datamigration
MONITOR = ${BIN_DIR}/monitor
XMLCFG = ${BIN_DIR}/xmlcfg
AGENTCLI = ${BIN_DIR}/agentcli
GETINPUT = ${BIN_DIR}/getinput
LIB_COMMON = ${BIN_DIR}/libcommon.so
LIB_HOST = ${PLUGINS_DIR}/libhost-${AGENT_BUILD_NUM}.so
LIB_DEVICE = ${PLUGINS_DIR}/libdevice-${AGENT_BUILD_NUM}.so
LIB_ORACLE = ${PLUGINS_DIR}/liboracle-${AGENT_BUILD_NUM}.so
LIB_DB2 = ${PLUGINS_DIR}/libdb2-${AGENT_BUILD_NUM}.so
LIB_CLUSTER = ${PLUGINS_DIR}/libcluster-${AGENT_BUILD_NUM}.so
LIB_CACHE = ${PLUGINS_DIR}/libcache-${AGENT_BUILD_NUM}.so
LIB_APP = ${PLUGINS_DIR}/libapp-${AGENT_BUILD_NUM}.so
LIB_SYBASE = ${PLUGINS_DIR}/libsybase-${AGENT_BUILD_NUM}.so
LIB_HANA = ${PLUGINS_DIR}/libhana-${AGENT_BUILD_NUM}.so

TARGET = ${AGENT} ${MONITOR} ${ROOTEXEC} ${CRYPTO} ${SCRIPTSIGN} ${DATAMIGRATION} ${XMLCFG} ${AGENTCLI} ${GETINPUT} ${LIB_COMMON} ${LIB_HOST} ${LIB_DEVICE} ${LIB_ORACLE} ${LIB_DB2} ${LIB_CLUSTER} ${LIB_CACHE} ${LIB_APP} ${LIB_SYBASE} ${LIB_HANA}

all:${TARGET}

${AGENT}:${LIB_COMMON} ${AGENT_OBJS} ${PLUGINFX_OBJS} ${PLUGINS_OBJS} ${ALARM_OBJS}
	${CPPC} ${oFLAGS} -o ${AGENT} ${AGENT_OBJS} ${PLUGINFX_OBJS} ${PLUGINS_OBJS} ${ALARM_OBJS} \
	-L${BIN_DIR} -L${OPEN_SNMP_LIB_DIR} -L${OPEN_OPENSSL_LIB_DIR} -L${OPEN_FCGI_LIB_DIR} \
	-lcommon -lpthread -lsnmp++ -lcrypto -lfcgi -lrt ${COV_OFLAGS}

#static link common and other objs, don't use common dynamic library
${ROOTEXEC}:${COMMON_OBJS} ${SECUREC_OBJS} ${KMC_OBJS} ${TINYXML_OBJS} ${ROOT_EXEC_OBJS} ${ARRAY_OBJS}
	${CPPC} ${OFLAGS} -o ${ROOTEXEC} ${COMMON_OBJS} ${SECUREC_OBJS} ${KMC_OBJS} ${TINYXML_OBJS} ${ROOT_EXEC_OBJS} \
	${ARRAY_OBJS} -L${OPEN_OPENSSL_LIB_DIR} -ldl -lrt -lpthread -lcrypto ${COV_OFLAGS}

${CRYPTO}:${COMMON_OBJS} ${CRYPTO_OBJS} ${SECUREC_OBJS} ${KMC_OBJS} ${TINYXML_OBJS}
	${CPPC} ${OFLAGS} -o ${CRYPTO} ${CRYPTO_OBJS} ${COMMON_OBJS} ${SECUREC_OBJS} ${KMC_OBJS} ${TINYXML_OBJS} -L${OPEN_OPENSSL_LIB_DIR} \
	-lcrypto -lpthread -ldl -lrt ${COV_OFLAGS}
	
${SCRIPTSIGN}:${COMMON_OBJS} ${SCRIPTSIGN_OBJS} ${SECUREC_OBJS} ${KMC_OBJS} ${TINYXML_OBJS}
	${CPPC} ${OFLAGS} -o ${SCRIPTSIGN} ${SCRIPTSIGN_OBJS} ${COMMON_OBJS} ${SECUREC_OBJS} ${KMC_OBJS} ${TINYXML_OBJS} -L${OPEN_OPENSSL_LIB_DIR} \
	-lcrypto -lpthread -ldl -lrt ${COV_OFLAGS}
    
${DATAMIGRATION}:${COMMON_OBJS} ${DATAMIGRATION_OBJS} ${SECUREC_OBJS} ${KMC_OBJS} ${TINYXML_OBJS} ${ALARM_OBJS} ${SQLITE_OBJS}
	${CPPC} ${OFLAGS} -o ${DATAMIGRATION} ${DATAMIGRATION_OBJS} ${COMMON_OBJS} ${SECUREC_OBJS} ${KMC_OBJS} ${TINYXML_OBJS} ${ALARM_OBJS} ${SQLITE_OBJS} \
    -L${BIN_DIR} -L${OPEN_OPENSSL_LIB_DIR} -L${OPEN_SNMP_LIB_DIR} -lsnmp++ -lcrypto -lpthread -ldl -lrt ${COV_OFLAGS}
	
${MONITOR}:${COMMON_OBJS} ${MONITOR_OBJS} ${SECUREC_OBJS} ${KMC_OBJS} ${TINYXML_OBJS} ${ALARM_OBJS} ${SQLITE_OBJS}
	${CPPC} ${OFLAGS} -o ${MONITOR} ${MONITOR_OBJS} ${COMMON_OBJS}  ${SECUREC_OBJS} ${KMC_OBJS} ${TINYXML_OBJS} ${ALARM_OBJS} ${SQLITE_OBJS} \
	-L${OPEN_OPENSSL_LIB_DIR} -L${OPEN_SNMP_LIB_DIR} -lpthread -lsnmp++ -ldl -lrt -lcrypto ${COV_OFLAGS}

${XMLCFG}:${COMMON_OBJS} ${XMLCFG_OBJS} ${SECUREC_OBJS} ${KMC_OBJS} ${TINYXML_OBJS}
	${CPPC} ${OFLAGS} -o ${XMLCFG} ${XMLCFG_OBJS} ${COMMON_OBJS}  ${SECUREC_OBJS} ${KMC_OBJS} ${TINYXML_OBJS} \
	-L${OPEN_OPENSSL_LIB_DIR} -lpthread -ldl -lrt -lcrypto ${COV_OFLAGS}
	
${AGENTCLI}:${COMMON_OBJS} ${AGENTCLI_OBJS} ${SECUREC_OBJS} ${KMC_OBJS} ${TINYXML_OBJS} ${ARRAY_OBJS}
	${CPPC} ${OFLAGS} -o ${AGENTCLI} ${AGENTCLI_OBJS} ${COMMON_OBJS} ${SECUREC_OBJS} ${KMC_OBJS} ${TINYXML_OBJS} ${ARRAY_OBJS} \
	-L${OPEN_OPENSSL_LIB_DIR} -lpthread -ldl -lrt -lcrypto ${COV_OFLAGS}
	
${GETINPUT}:${COMMON_OBJS} ${GETINPUT_OBJS} ${SECUREC_OBJS} ${KMC_OBJS} ${TINYXML_OBJS}
	${CPPC} ${OFLAGS} -o ${GETINPUT} ${GETINPUT_OBJS} ${COMMON_OBJS}  ${SECUREC_OBJS} ${KMC_OBJS} ${TINYXML_OBJS} \
	-L${OPEN_OPENSSL_LIB_DIR} -lpthread -ldl -lrt -lcrypto ${COV_OFLAGS}
	
${LIB_COMMON}:${COMMON_OBJS} ${REST_OBJS} ${ARRAY_OBJS} ${SECUREC_OBJS} ${KMC_OBJS} ${TINYXML_OBJS} ${JSON_OBJS} ${SQLITE_OBJS} 
	${CPPC} ${DFLAGS} -o ${LIB_COMMON} ${COMMON_OBJS} ${REST_OBJS} ${ARRAY_OBJS} ${SECUREC_OBJS} ${KMC_OBJS} ${TINYXML_OBJS} \
	${JSON_OBJS} ${SQLITE_OBJS} -L${OPEN_OPENSSL_LIB_DIR} -L${OPEN_FCGI_LIB_DIR} -ldl -lpthread -lrt -lcrypto -lfcgi ${COV_OFLAGS}

${LIB_HOST}:${HOST_OBJS} ${PLUGINS_OBJS} ${PLUGINS_HOST_OBJS} ${ALARM_OBJS}
	${CPPC} ${dFLAGS} -o ${LIB_HOST} ${HOST_OBJS} ${PLUGINS_OBJS} ${PLUGINS_HOST_OBJS} ${ALARM_OBJS} -L${OPEN_OPENSSL_LIB_DIR} \
	-L${OPEN_FCGI_LIB_DIR} -L${OPEN_SNMP_LIB_DIR} -L${BIN_DIR} -lsnmp++ -lssl -lcrypto -lcommon -lrt ${COV_OFLAGS}

${LIB_DEVICE}:${DEVICE_OBJS} ${PLUGINS_OBJS} ${PLUGINS_DEVICE_OBJS} ${ALARM_OBJS}
	${CPPC} ${dFLAGS} -o ${LIB_DEVICE} ${DEVICE_OBJS} ${PLUGINS_OBJS} ${PLUGINS_DEVICE_OBJS} ${ALARM_OBJS} -L${OPEN_OPENSSL_LIB_DIR} \
	-L${OPEN_SNMP_LIB_DIR} -L${BIN_DIR} -lsnmp++ -lcrypto -lcommon -lrt ${COV_OFLAGS}

${LIB_CLUSTER}:${CLUSTER_OBJS} ${PLUGINS_OBJS} ${PLUGINS_CLUSTER_OBJS}
	${CPPC} ${dFLAGS} -o ${LIB_CLUSTER} ${CLUSTER_OBJS} ${PLUGINS_OBJS} ${PLUGINS_CLUSTER_OBJS} -L${BIN_DIR} -lcommon ${COV_OFLAGS}

${LIB_ORACLE}:${APPS_ORACLE_OBJS} ${PLUGINS_OBJS} ${PLUGINS_ORACLE_OBJS}
	${CPPC} ${dFLAGS} -o ${LIB_ORACLE} ${APPS_ORACLE_OBJS} ${PLUGINS_OBJS} ${PLUGINS_ORACLE_OBJS} -L${BIN_DIR} -lcommon ${COV_OFLAGS}

${LIB_DB2}:${APPS_DB2_OBJS} ${PLUGINS_OBJS} ${PLUGINS_DB2_OBJS}
	${CPPC} ${dFLAGS} -o ${LIB_DB2} ${APPS_DB2_OBJS} ${PLUGINS_OBJS} ${PLUGINS_DB2_OBJS} -L${BIN_DIR} -lcommon ${COV_OFLAGS}

${LIB_CACHE}:${APPS_CACHE_OBJS} ${PLUGINS_OBJS} ${PLUGINS_CACHE_OBJS}
	${CPPC} ${dFLAGS} -o ${LIB_CACHE} ${APPS_CACHE_OBJS} ${PLUGINS_OBJS} ${PLUGINS_CACHE_OBJS} -L${BIN_DIR} -lcommon ${COV_OFLAGS}

${LIB_SYBASE}:${APPS_SYBASE_OBJS} ${PLUGINS_OBJS} ${PLUGINS_SYBASE_OBJS}
	${CPPC} ${dFLAGS} -o ${LIB_SYBASE} ${APPS_SYBASE_OBJS} ${PLUGINS_OBJS} ${PLUGINS_SYBASE_OBJS} -L${BIN_DIR} -lcommon ${COV_OFLAGS}
    
${LIB_HANA}:${APPS_HANA_OBJS} ${PLUGINS_OBJS} ${PLUGINS_HANA_OBJS}
	${CPPC} ${dFLAGS} -o ${LIB_HANA} ${APPS_HANA_OBJS} ${PLUGINS_OBJS} ${PLUGINS_HANA_OBJS} -L${BIN_DIR} -lcommon ${COV_OFLAGS}

${LIB_APP}:${APPS_APP_OBJS} ${PLUGINS_OBJS} ${PLUGINS_APP_OBJS} ${APPS_ORACLE_OBJS}
	${CPPC} ${dFLAGS} -o ${LIB_APP} ${APPS_APP_OBJS} ${PLUGINS_OBJS} ${PLUGINS_APP_OBJS} ${APPS_ORACLE_OBJS} -L${BIN_DIR} -lcommon ${COV_OFLAGS}
	
${COMMON_OBJS}:${OBJ_COMMON_DIR}/%.o:${SRC_COMMON_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${INC_SECUREC_DIR} -I${INC_KMC_DIR} -I${BASE_OPEN_INC} -I${INC_OPEN_OPENSSL_DIR} \
	-I${INC_OPEN_TINYXML_DIR} -o $@ -c $< ${COV_CFLAGS}

${ARRAY_OBJS}:${OBJ_ARRAY_DIR}/%.o:${SRC_ARRAY_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${INC_SECUREC_DIR} -I${BASE_OPEN_INC} -o $@ -c $< ${COV_CFLAGS}
	
${CLUSTER_OBJS}:${OBJ_CLUSTER_DIR}/%.o:${SRC_CLUSTER_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${INC_SECUREC_DIR} -I${BASE_OPEN_INC} -o $@ -c $< ${COV_CFLAGS}

${DEVICE_OBJS}:${OBJ_DEVICE_DIR}/%.o:${SRC_DEVICE_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${INC_SECUREC_DIR} -I${OPEN_SRC_DIR} -o $@ -c $< ${COV_CFLAGS}

${HOST_OBJS}:${OBJ_HOST_DIR}/%.o:${SRC_HOST_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${INC_SECUREC_DIR} -o $@ -c $< ${COV_CFLAGS}
	
${APPS_DB2_OBJS}:${OBJ_APPS_DB2_DIR}/%.o:${SRC_APPS_DB2_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${INC_SECUREC_DIR} -o $@ -c $< ${COV_CFLAGS}

${APPS_ORACLE_OBJS}:${OBJ_APPS_ORACLE_DIR}/%.o:${SRC_APPS_ORACLE_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${INC_SECUREC_DIR} -o $@ -c $< ${COV_CFLAGS}

${APPS_CACHE_OBJS}:${OBJ_APPS_CACHE_DIR}/%.o:${SRC_APPS_CACHE_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${INC_SECUREC_DIR} -o $@ -c $<  ${COV_OFLAGS}

${APPS_SYBASE_OBJS}:${OBJ_APPS_SYBASE_DIR}/%.o:${SRC_APPS_SYBASE_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${INC_SECUREC_DIR} -o $@ -c $<  ${COV_OFLAGS}

${APPS_HANA_OBJS}:${OBJ_APPS_HANA_DIR}/%.o:${SRC_APPS_HANA_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${INC_SECUREC_DIR} -o $@ -c $<  ${COV_OFLAGS}
    
${APPS_APP_OBJS}:${OBJ_APPS_APP_DIR}/%.o:${SRC_APPS_APP_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${INC_SECUREC_DIR} -o $@ -c $< ${COV_CFLAGS}
	
${SQLITE_OBJS}:${SRC_OPEN_SQLITE_DIR}/sqlite3.c
	${cc} ${cFLAGS} ${RD_CFLAGS} -I${INC_OPEN_SQLITE_DIR} -o $@ -c ${SRC_OPEN_SQLITE_DIR}/sqlite3.c
	
${AGENT_OBJS}:${OBJ_AGENT_DIR}/%.o:${SRC_AGENT_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${BASE_OPEN_INC} -I${INC_SECUREC_DIR} -I${INC_OPEN_OPENSSL_DIR} \
	-I${INC_OPEN_TINYXML_DIR} -I${INC_OPEN_SNMP_DIR} -I${INC_OPEN_SNMP_MAIN_DIR} -o $@ -c $< ${COV_CFLAGS}
	
${ROOT_EXEC_OBJS}:${OBJ_ROOT_EXEC_DIR}/%.o:${SRC_ROOT_EXEC_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${INC_SECUREC_DIR} -I${INC_OPEN_TINYXML_DIR} -o $@ -c $< ${COV_CFLAGS}
	
${CRYPTO_OBJS}:${OBJ_CRYPTO_DIR}/%.o:${SRC_CRYPTO_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${INC_SECUREC_DIR} -I${INC_OPEN_OPENSSL_DIR} -I${INC_OPEN_TINYXML_DIR} \
	-o $@ -c $< ${COV_CFLAGS}
	
${SCRIPTSIGN_OBJS}:${OBJ_SCRIPTSIGN_DIR}/%.o:${SRC_SCRIPTSIGN_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${INC_SECUREC_DIR} -I${INC_OPEN_OPENSSL_DIR} -I${INC_OPEN_TINYXML_DIR} \
	-o $@ -c $< ${COV_CFLAGS}

${DATAMIGRATION_OBJS}:${OBJ_DATAMIGRATION_DIR}/%.o:${SRC_DATAMIGRATION_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${BASE_OPEN_INC} -I${INC_SECUREC_DIR} -I${INC_OPEN_TINYXML_DIR} \
	-o $@ -c $< ${COV_CFLAGS}
	
${MONITOR_OBJS}:${OBJ_MONITOR_DIR}/%.o:${SRC_MONITOR_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${BASE_OPEN_INC} -I${INC_SECUREC_DIR} -I${INC_OPEN_TINYXML_DIR} \
	-I${INC_OPEN_SNMP_DIR} -I${INC_OPEN_SNMP_MAIN_DIR} -o $@ -c $< ${COV_CFLAGS}
	
${XMLCFG_OBJS}:${OBJ_XMLCFG_DIR}/%.o:${SRC_XMLCFG_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${BASE_OPEN_INC} -I${INC_SECUREC_DIR} -I${INC_OPEN_TINYXML_DIR} \
	-o $@ -c $< ${COV_CFLAGS}
	
${AGENTCLI_OBJS}:${OBJ_AGENTCLI_DIR}/%.o:${SRC_AGENTCLI_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${BASE_OPEN_INC} -I${INC_SECUREC_DIR} -I${INC_OPEN_TINYXML_DIR} \
	-o $@ -c $< ${COV_CFLAGS}
	
${GETINPUT_OBJS}:${OBJ_GETINPUT_DIR}/%.o:${SRC_GETINPUT_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${BASE_OPEN_INC} -I${INC_SECUREC_DIR} -I${INC_OPEN_TINYXML_DIR} \
	-o $@ -c $< ${COV_CFLAGS}

${REST_OBJS}:${OBJ_REST_DIR}/%.o:${SRC_REST_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${BASE_OPEN_INC} -I${INC_SECUREC_DIR} -o $@ -c $< ${COV_CFLAGS}
	
${ALARM_OBJS}:${OBJ_ALARM_DIR}/%.o:${SRC_ALARM_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${BASE_OPEN_INC} -I${INC_SECUREC_DIR} -I${INC_OPEN_SNMP_DIR} \
	-I${INC_OPEN_SNMP_MAIN_DIR} -I${INC_OPEN_TINYXML_DIR} -o $@ -c $< ${COV_CFLAGS}

${PLUGINFX_OBJS}:${OBJ_PLUGINFX_DIR}/%.o:${SRC_PLUGINFX_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${BASE_OPEN_INC} -I${INC_SECUREC_DIR} -o $@ -c $< ${COV_CFLAGS}

${PLUGINS_OBJS}:${OBJ_PLUGINS_DIR}/%.o:${SRC_PLUGINS_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${BASE_OPEN_INC} -I${INC_SECUREC_DIR} -o $@ -c $< ${COV_CFLAGS}

${PLUGINS_DEVICE_OBJS}:${OBJ_PLUGINS_DEVICE_DIR}/%.o:${SRC_PLUGINS_DEVICE_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${BASE_OPEN_INC} -I${INC_SECUREC_DIR} -o $@ -c $< ${COV_CFLAGS}

${PLUGINS_CLUSTER_OBJS}:${OBJ_PLUGINS_CLUSTER_DIR}/%.o:${SRC_PLUGINS_CLUSTER_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${BASE_OPEN_INC} -I${INC_SECUREC_DIR} -o $@ -c $< ${COV_CFLAGS}

${PLUGINS_HOST_OBJS}:${OBJ_PLUGINS_HOST_DIR}/%.o:${SRC_PLUGINS_HOST_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${BASE_OPEN_INC} -I${INC_SECUREC_DIR} -o $@ -c $< ${COV_CFLAGS}

${PLUGINS_DB2_OBJS}:${OBJ_PLUGINS_DB2_DIR}/%.o:${SRC_PLUGINS_DB2_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${BASE_OPEN_INC} -I${INC_SECUREC_DIR} -o $@ -c $< ${COV_CFLAGS}
	
${PLUGINS_ORACLE_OBJS}:${OBJ_PLUGINS_ORACLE_DIR}/%.o:${SRC_PLUGINS_ORACLE_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${BASE_OPEN_INC} -I${INC_SECUREC_DIR} -o $@ -c $< ${COV_CFLAGS}

${PLUGINS_CACHE_OBJS}:${OBJ_PLUGINS_CACHE_DIR}/%.o:${SRC_PLUGINS_CACHE_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${BASE_OPEN_INC} -I${INC_SECUREC_DIR} -o $@ -c $< ${COV_OFLAGS}
    
${PLUGINS_SYBASE_OBJS}:${OBJ_PLUGINS_SYBASE_DIR}/%.o:${SRC_PLUGINS_SYBASE_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${BASE_OPEN_INC} -I${INC_SECUREC_DIR} -o $@ -c $< ${COV_OFLAGS}
    
${PLUGINS_HANA_OBJS}:${OBJ_PLUGINS_HANA_DIR}/%.o:${SRC_PLUGINS_HANA_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${BASE_OPEN_INC} -I${INC_SECUREC_DIR} -o $@ -c $< ${COV_OFLAGS}

${PLUGINS_APP_OBJS}:${OBJ_PLUGINS_APP_DIR}/%.o:${SRC_PLUGINS_APP_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${BASE_INC} -I${BASE_OPEN_INC} -I${INC_SECUREC_DIR} -o $@ -c $< ${COV_CFLAGS}

${JSON_OBJS}:${OBJ_JSON_DIR}/%.o:${SRC_JSON_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${INC_OPEN_JSON_DIR} -o $@ -c $<

${TINYXML_OBJS}:${OBJ_TINYXML_DIR}/%.o:${SRC_TINYXML_DIR}/%.cpp
	${CPPC} ${CFLAGS} -I${INC_OPEN_TINYXML_DIR} -o $@ -c $<

${SECUREC_OBJS}:${OBJ_SECUREC_DIR}/%.o:${SRC_SECUREC_DIR}/%.c
	${cc} ${cFLAGS} -I${INC_SECUREC_DIR} -o $@ -c $<
    
${KMC_OBJS}:${OBJ_KMC_DIR}/%.o:${SRC_KMC_DIR}/%.cpp
	${CPPC} ${cFLAGS} -I${BASE_INC} -I${INC_KMC_DIR} -I${INC_OPEN_OPENSSL_DIR} -I${INC_SECUREC_DIR} -o $@ -c $< ${COV_CFLAGS}

clean:
	find ${OBJ_DIR} -name "*.o" | xargs -L 1  rm -rf
	rm -rf ${TARGET}

